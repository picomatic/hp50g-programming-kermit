@CECC.s - Common emitter and common collector impedance calculation
<<
 "COMMON EMITTER & COLLECTOR"
{
{ "R1:" "Enter R1" 0 }
{ "R2:" "Enter R2" 0 }
{ "RC:" "Enter RC" 0 }
{ "RE:" "Enter RE" 0 }
{ "Ic:" "Enter collector current" 0 }
{ "Va:" "Enter early voltage" 0 }
{ "ß:" "Enter ß" 0 }
}
2
{ }
{ 1E3 1E3 0 0 0 100 100}
INFORM
DROP OBJ-> DROP
-> R1 R2 Rc Re Ic Va B
   <<
   'B*25E-3/Ic' EVAL 'rp' STO
   'Va/Ic' EVAL 'ro' STO
   'INV(INV(R1)+INV(R2)+INV(rp+Re*(Rc+(B+1)*ro)/(Rc+Re+ro)))' EVAL 'Zi' STO
   'INV(INV(Rc)+INV(ro+Re*(INV(INV(R1)+INV(R2))+rp+B*ro)/(Re+INV(INV(R1)+INV(R2))+rp)))' EVAL 'Zc' STO
   'INV(INV(Re)+INV(rp/B))' EVAL 'Ze' STO
   '-B*INV(INV(Rc)+INV(ro))/(rp+(B+1)*Re)' EVAL 'AvCB' STO
   '(B+1)*Re/(rp+(B+1)*Re)' EVAL 'AvEB' STO
   
   Zi Zc Ze rp ro ro 6 ->LIST 'IMPED' STO
   AvCB AvEB 2 ->LIST 'GAIN' STO
   
   "Result: Impedanc"
   {
   { "Zi =" "Input impedance" 0 }
   { "Zc =" "Zo into collector" 0 }
   { "Ze =" "Zo into emiter" 0 }
   { "rp =" "rp value" 0 }
   { "ro =" "ro value" 0 }
   { "ro =" "dummy" 0 }
   }
   2
   { }
   IMPED
   INFORM
   DROP DROP
   "Results: Gain"
   {
   { "AvCB=" "Gain Colector/Base" 0 }
   { "AvEB=" "Gain Emisor/Base" 0 }
   }
   { 1 1 }
   GAIN
   DUP
   INFORM
  >>
  DROP DROP
  { rp ro Zi Zc Ze AvCB AvEB IMPED GAIN} PURGE
>>
